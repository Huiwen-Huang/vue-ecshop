"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[936],{7649:function(t,a,e){var s=e(4373),i=e(5234),n=e(4161);const o=(0,n.A)();a.A=(0,i.nY)("cartState",{state:()=>({carts:[],total:"",finalTotal:""}),actions:{getCart(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";o.isLoading=!0,s.A.get(t).then((t=>{o.isLoading=!1,console.log("getCart",t),t.data.success&&(this.carts=t.data.data.carts,this.total=t.data.data.total,this.finalTotal=t.data.data.final_total)}))},updateCart(t){const a=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${t.id}`,e={product_id:t.product_id,qty:t.qty};o.isLoading=!0,o.cartLoadingItem=t.id,s.A.put(a,{data:e}).then((t=>{console.log("updateCart",t),o.isLoading=!1,o.cartLoadingItem="",this.getCart()}))}}})},3864:function(t,a,e){var s=e(4373),i=e(5234),n=e(4161),o=e(7649);const c=(0,n.A)(),r=(0,o.A)();a.A=(0,i.nY)("productState",{state:()=>({products:[],pagination:{}}),getters:{sortProducts:t=>t.products.sort(((t,a)=>t.price-a.price))},actions:{getProducts(t=1){const a=`https://vue3-course-api.hexschool.io/api/ecshop-api/products/?page=${t}`;c.isLoading=!0,s.A.get(a).then((t=>{this.products=t.data.products,this.pagination=t.data.pagination,c.isLoading=!1,console.log("getProducts",t.data)}))},addCart(t){const a="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";c.cartLoadingItem=t;const e={product_id:t,qty:1};s.A.post(a,{data:e}).then((t=>{c.cartLoadingItem="",console.log("addCart",t),t.data.success&&r.getCart()}))}}})},4161:function(t,a,e){var s=e(5234);a.A=(0,s.nY)("statusState",{state:()=>({isLoading:!1,cartLoadingItem:""})})},4324:function(t,a,e){e.d(a,{A:function(){return C}});var s=e(6768),i=e(4232),n=e(5130);const o={class:"d-flex justify-content-center"},c={"aria-label":"Page navigation example"},r={class:"pagination"},d=(0,s.Lk)("span",{"aria-hidden":"true"},"«",-1),l=[d],u=["onClick"],p=(0,s.Lk)("span",{"aria-hidden":"true"},"»",-1),g=[p];function h(t,a,e,d,p,h){return(0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("nav",c,[(0,s.Lk)("ul",r,[(0,s.Lk)("li",{class:(0,i.C4)(["page-item text-warning",{disabled:!1===e.pages.has_pre}])},[(0,s.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:a[0]||(a[0]=(0,n.D$)((t=>h.updatePage(e.pages.current_page-1)),["prevent"]))},l)],2),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.pages.total_pages,(t=>((0,s.uX)(),(0,s.CE)("li",{class:(0,i.C4)(["page-item",{active:t===e.pages.current_page}]),key:t},[(0,s.Lk)("a",{class:"page-link",href:"#",onClick:(0,n.D$)((a=>h.updatePage(t)),["prevent"])},(0,i.v_)(t),9,u)],2)))),128)),(0,s.Lk)("li",{class:(0,i.C4)(["page-item",{disabled:!1===e.pages.has_next}])},[(0,s.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:a[1]||(a[1]=(0,n.D$)((t=>h.updatePage(e.pages.current_page+1)),["prevent"]))},g)],2)])])])}var k={props:["pages"],methods:{updatePage(t){this.$emit("emit-pages",t)}}},L=e(1241);const v=(0,L.A)(k,[["render",h]]);var C=v},2936:function(t,a,e){e.r(a),e.d(a,{default:function(){return _}});var s=e(6768),i=e(4232);const n={class:"col d-flex flex-wrap justify-content-center"},o={class:"card-body"},c={class:"card-title"},r={class:"card-text"},d={class:"d-flex justify-content-center"},l=["onClick"],u=["disabled","onClick"],p={key:0,class:"spinner-border spinner-border-sm",role:"status"},g=(0,s.Lk)("span",{class:"visually-hidden"},"Loading...",-1),h=[g],k=(0,s.Lk)("i",{class:"bi bi-cart4"},null,-1),L={class:"container"};function v(t,a,e,g,v,C){const m=(0,s.g2)("LoadingOverlay"),b=(0,s.g2)("PaginationCard");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(m,{active:t.isLoading},null,8,["active"]),(0,s.Lk)("div",n,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.sortProducts,(a=>((0,s.uX)(),(0,s.CE)("div",{key:a.id,class:"card mx-4 mb-4 shadow rounded",style:{width:"18rem"}},[(0,s.Lk)("div",{style:(0,i.Tr)([{height:"200px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${a.imageUrl})`}])},null,4),(0,s.Lk)("div",o,[(0,s.Lk)("h5",c,(0,i.v_)(a.title),1),(0,s.Lk)("p",r,"NT$ "+(0,i.v_)(a.price),1),(0,s.Lk)("div",d,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-secondary me-2",onClick:t=>C.getProduct(a.id)},"查看更多",8,l),(0,s.Lk)("button",{class:"btn btn-outline-warning",disabled:t.cartLoadingItem===a.id,onClick:e=>t.addCart(a.id)},[t.cartLoadingItem===a.id?((0,s.uX)(),(0,s.CE)("div",p,h)):(0,s.Q3)("",!0),k,(0,s.eW)(" 加入購物車 ")],8,u)])])])))),128))]),(0,s.Lk)("div",L,[(0,s.bF)(b,{pages:t.pagination,onEmitPages:t.getProducts},null,8,["pages","onEmitPages"])])],64)}e(4114);var C=e(4324),m=e(3864),b=e(4161),f=e(7649),A=e(5234),P={components:{PaginationCard:C.A},inject:["emitter"],computed:{...(0,A.aH)(m.A,["sortProducts","pagination"]),...(0,A.aH)(b.A,["isLoading","cartLoadingItem"]),...(0,A.aH)(f.A,["carts"])},methods:{...(0,A.i0)(m.A,["getProducts"]),...(0,A.i0)(f.A,["getCart"]),getProduct(t){this.$router.push(`/product/${t}`)},...(0,A.i0)(m.A,["addCart"])},created(){this.getProducts(),this.getCart()}},y=e(1241);const x=(0,y.A)(P,[["render",v]]);var _=x}}]);
//# sourceMappingURL=936.7bb9a16e.js.map