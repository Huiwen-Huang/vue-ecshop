"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[372],{5372:function(t,e,a){a.r(e),a.d(e,{default:function(){return O}});var o=a(6768),s=a(4232),i=a(5130);const r={class:"container"},c={class:"row mt-4"},n={class:"col-md-2"},d={class:"row"},l={class:"col-lg-12 col-md-3 col-6"},u=["onClick"],g={class:"col-md-9 col-11 ms-auto"},p={class:"row"},h=["onClick"],v={class:"card-body"},C={class:"card-title mb-4"},k={class:"card-text float-end"},L={class:"d-flex justify-content-center"},b=["disabled","onClick"],f={key:0,class:"spinner-border spinner-border-sm",role:"status"},m=(0,o.Lk)("span",{class:"visually-hidden"},"Loading...",-1),y=[m],w=(0,o.Lk)("i",{class:"bi bi-cart4"},null,-1);function A(t,e,a,m,A,x){const I=(0,o.g2)("ShopNavbar"),P=(0,o.g2)("LoadingOverlay"),$=(0,o.g2)("CartCanvas");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(I),(0,o.bF)(P,{active:t.isLoading},null,8,["active"]),(0,o.Lk)("div",r,[(0,o.Lk)("div",c,[(0,o.Lk)("div",n,[(0,o.Lk)("div",d,[(0,o.Lk)("div",l,[(0,o.Lk)("button",{type:"button",class:(0,s.C4)(["btn btn-outline-warning fw-bold text-center mb-4 w-100",{active:""===A.filterCategory}]),onClick:e[0]||(e[0]=(0,i.D$)((t=>A.filterCategory=""),["prevent"]))},"全部商品 ",2)]),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.categories,(t=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:"col-lg-12 col-md-3 col-6"},[(0,o.Lk)("button",{type:"button",class:(0,s.C4)(["btn btn-outline-warning fw-bold text-center mb-4 w-100",{active:A.filterCategory===t}]),onClick:(0,i.D$)((e=>A.filterCategory=t),["prevent"])},(0,s.v_)(t),11,u)])))),128))])]),(0,o.Lk)("div",g,[(0,o.Lk)("div",p,[(0,o.Lk)("div",null,(0,s.v_)(x.filterCategories.category),1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(x.filterCategories,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id,class:"card mx-3 mb-4 shadow rounded p-0",style:{width:"18rem"}},[(0,o.Lk)("a",{href:"",onClick:(0,i.D$)((t=>x.getProduct(e.id)),["prevent"])},[(0,o.Lk)("div",{style:(0,s.Tr)([{height:"200px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${e.imageUrl})`}])},null,4)],8,h),(0,o.Lk)("div",v,[(0,o.Lk)("h6",C,[(0,o.eW)((0,s.v_)(e.title)+" ",1),(0,o.Lk)("span",k,"NT$ "+(0,s.v_)(e.price),1)]),(0,o.Lk)("div",L,[(0,o.Lk)("button",{class:"btn btn-outline-warning w-100",disabled:t.cartLoadingItem===e.id,onClick:t=>x.addCart(e.id)},[t.cartLoadingItem===e.id?((0,o.uX)(),(0,o.CE)("div",f,y)):(0,o.Q3)("",!0),w,(0,o.eW)(" 加入購物車 ")],8,b)])])])))),128))])])]),(0,o.bF)($,{ref:"canvas"},null,512)])],64)}a(4114);var x=a(4351),I=a(3885),P=a(4373),$=a(5234),_=a(4161),E=a(7649);const F=(0,_.A)(),X=(0,E.A)();var D=(0,$.nY)("productState",{state:()=>({products:[],categories:{},pagination:{}}),getters:{},actions:{getAllProducts(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/products/all";F.isLoading=!0,P.A.get(t).then((t=>{F.isLoading=!1,console.log("getAllProducts",t.data),this.products=t.data.products;const e=this.products.map((t=>t.category)),a=e.filter(((t,a)=>e.indexOf(t)===a));this.categories=a}))},getProducts(t=1){const e=`https://vue3-course-api.hexschool.io/api/ecshop-api/products?page=${t}`;F.isLoading=!0,P.A.get(e).then((t=>{F.isLoading=!1,console.log("getProducts",t.data),this.products=t.data.products,this.pagination=t.data.pagination;const e=this.products.map((t=>t.category)),a=e.filter(((t,a)=>e.indexOf(t)===a));this.categories=a}))},addCart(t){const e="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";F.cartLoadingItem=t;const a={product_id:t,qty:1};P.A.post(e,{data:a}).then((t=>{F.cartLoadingItem="",console.log("addCart",t),t.data.success&&X.getCart()}))}}}),H={data(){return{filterCategory:""}},components:{ShopNavbar:I.A,CartCanvas:x.A},inject:["emitter"],computed:{...(0,$.aH)(D,["products","categories"]),...(0,$.aH)(_.A,["isLoading","cartLoadingItem"]),...(0,$.aH)(E.A,["carts"]),filterCategories(){let t=this.products;return this.filterCategory&&(t=t.filter((t=>t.category.toLowerCase().includes(this.filterCategory.toLowerCase())))),t.sort(((t,e)=>t.price-e.price))}},methods:{...(0,$.i0)(D,["getAllProducts"]),...(0,$.i0)(D,["getProducts"]),...(0,$.i0)(E.A,["getCart"]),getProduct(t){this.$router.push(`/product/${t}`)},addCart(t){const e="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";this.cartLoadingItem=t;const a={product_id:t,qty:1};this.axios.post(e,{data:a}).then((t=>{this.cartLoadingItem="",console.log("addCart",t),t.data.success&&(this.getCart(),this.$refs.canvas.showCanvas())}))}},created(){this.getAllProducts(),this.getCart()}},K=a(1241);const N=(0,K.A)(H,[["render",A]]);var O=N}}]);
//# sourceMappingURL=372.b0d8a3a1.js.map