"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[434],{7649:function(t,e,o){var a=o(4373),s=o(5234),l=o(4161);const d=(0,l.A)();e.A=(0,s.nY)("productState",{state:()=>({carts:[],total:"",finalTotal:""}),actions:{getCart(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";d.isLoading=!0,a.A.get(t).then((t=>{d.isLoading=!1,console.log("getCart",t),t.data.success&&(this.carts=t.data.data.carts,this.total=t.data.data.total,this.finalTotal=t.data.data.final_total)}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${t.id}`,o={product_id:t.product_id,qty:t.qty};d.isLoading=!0,d.cartLoadingItem=t.id,a.A.put(e,{data:o}).then((t=>{console.log("updateCart",t),d.isLoading=!1,d.cartLoadingItem="",this.getCart()}))}}})},4161:function(t,e,o){var a=o(5234);e.A=(0,a.nY)("statusState",{state:()=>({isLoading:!1,cartLoadingItem:""})})},8021:function(t,e,o){o.r(e),o.d(e,{default:function(){return ht}});var a=o(6768),s=o(4232),l=o(5130),d=o.p+"img/cartEmpty.0dfebce0.jpg";const n={class:"container"},i={key:0,class:"row"},c={class:"col text-center"},r={class:"text-secondary mt-4 fs-5"},u=(0,a.Lk)("img",{src:d,alt:"cartEmpty",style:{width:"500px"}},null,-1),p={key:1,class:"row"},m={class:"col-md-12 mb-4"},h={class:"table align-middle"},L=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{style:{width:"10%"}}),(0,a.Lk)("th",{class:"ps-5",style:{width:"30%"}},"商品資料"),(0,a.Lk)("th",{style:{width:"15%"}},"單價"),(0,a.Lk)("th",{style:{width:"8%"}},"數量"),(0,a.Lk)("th",{class:"text-end",style:{width:"25%"}},"小計"),(0,a.Lk)("th",{class:"text-end",style:{width:"20%"}})])],-1),k={class:"ps-5"},b={class:"input-group input-group-sm"},g=["disabled","onUpdate:modelValue","onChange"],v={class:"input-group-text"},f={class:"text-end"},C={class:"text-end"},y=["onClick"],x=(0,a.Lk)("i",{class:"bi bi-x"},null,-1),$=[x],_=(0,a.Lk)("td",{colspan:"5",class:"text-end"},"合計",-1),w={class:"text-end"},M={key:0},A=(0,a.Lk)("td",{colspan:"5",class:"text-end"},"套用優惠代碼",-1),I={class:"text-end"},T=(0,a.Lk)("td",{colspan:"5",class:"text-end fw-bold"},"結帳總金額",-1),E={class:"text-end fw-bold"},U={class:"input-group mb-3 input-group-sm"},D={class:"input-group-append"},V={class:"text-end mt-4"},J={class:"col-md-7 mx-auto shadow rounded px-5 mt-4 mb-4"},X=(0,a.Lk)("h2",{class:"mt-5"},"訂購資訊",-1),F=(0,a.Lk)("hr",{class:"mb-4"},null,-1),S={class:"mb-3"},W=(0,a.Lk)("label",{for:"name",class:"form-label"},"訂購人姓名",-1),q={class:"mb-3"},N=(0,a.Lk)("label",{for:"tel",class:"form-label"},"訂購人電話",-1),O={class:"mb-3"},j=(0,a.Lk)("label",{for:"eamil",class:"form-label"},"訂購人信箱",-1),H={class:"mb-3"},K=(0,a.Lk)("label",{for:"address",class:"form-label"},"收件地址",-1),Y={class:"mb-3"},z=(0,a.Lk)("label",{for:"note",class:"form-label"},"訂單備註",-1),Q={class:"text-end mt-4 mb-4"};function B(t,e,o,d,x,B){const G=(0,a.g2)("LoadingOverlay"),P=(0,a.g2)("router-link"),R=(0,a.g2)("CartDelModal");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(G,{active:t.isLoading},null,8,["active"]),(0,a.Lk)("div",n,[0===this.total?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",c,[(0,a.Lk)("p",r,[(0,a.eW)("購物車尚內無商品， "),(0,a.bF)(P,{to:"/shop/products",class:"link-secondary"},{default:(0,a.k6)((()=>[(0,a.eW)("點我")])),_:1}),(0,a.eW)(" 繼續選購！")]),u])])):((0,a.uX)(),(0,a.CE)("div",p,[(0,a.Lk)("div",m,[(0,a.Lk)("div",null,[(0,a.Lk)("table",h,[L,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.carts,(e=>((0,a.uX)(),(0,a.CE)("tr",{key:e.product.id},[(0,a.Lk)("td",null,[(0,a.Lk)("div",{style:(0,s.Tr)([{height:"80px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),(0,a.Lk)("td",k,(0,s.v_)(e.product.title),1),(0,a.Lk)("td",null,[(0,a.Lk)("div",null,"NT$ "+(0,s.v_)(e.product.price),1)]),(0,a.Lk)("td",null,[(0,a.Lk)("div",b,[(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",disabled:t.cartLoadingItem===e.id,"onUpdate:modelValue":t=>e.qty=t,min:"1",onChange:o=>t.updateCart(e)},null,40,g),[[l.Jo,e.qty,void 0,{number:!0}]]),(0,a.Lk)("div",v,"/ "+(0,s.v_)(e.product.unit),1)])]),(0,a.Lk)("td",f,[(0,a.Lk)("div",null,"NT$ "+(0,s.v_)(t.$filters.currency(e.total)),1)]),(0,a.Lk)("td",C,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:t=>B.openDelModal(e)},$,8,y)])])))),128))]),(0,a.Lk)("tfoot",null,[(0,a.Lk)("tr",null,[_,(0,a.Lk)("td",w,"NT$ "+(0,s.v_)(t.$filters.currency(this.total)),1)]),this.total!==this.finalTotal?((0,a.uX)(),(0,a.CE)("tr",M,[A,(0,a.Lk)("td",I,(0,s.v_)(this.carts[0]?.coupon?.code),1)])):(0,a.Q3)("",!0),(0,a.Lk)("tr",null,[T,(0,a.Lk)("td",E,"NT$ "+(0,s.v_)(t.$filters.currency(this.finalTotal)),1)])])]),(0,a.Lk)("div",U,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control me-3",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>x.coupon_code=t)},null,512),[[l.Jo,x.coupon_code]]),(0,a.Lk)("div",D,[(0,a.Lk)("button",{class:"btn btn-outline-warning",type:"button",onClick:e[1]||(e[1]=(...t)=>B.addCouponCode&&B.addCouponCode(...t))}," 套用優惠 ")])]),(0,a.Lk)("div",V,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(...t)=>B.removeAll&&B.removeAll(...t))}," 移除購物車 ")])])]),(0,a.Lk)("form",J,[X,F,(0,a.Lk)("div",S,[W,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[3]||(e[3]=t=>x.form.user.name=t)},null,512),[[l.Jo,x.form.user.name]])]),(0,a.Lk)("div",q,[N,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"tel","onUpdate:modelValue":e[4]||(e[4]=t=>x.form.user.tel=t)},null,512),[[l.Jo,x.form.user.tel]])]),(0,a.Lk)("div",O,[j,(0,a.bo)((0,a.Lk)("input",{type:"email",class:"form-control",id:"eamil","onUpdate:modelValue":e[5]||(e[5]=t=>x.form.user.email=t)},null,512),[[l.Jo,x.form.user.email]])]),(0,a.Lk)("div",H,[K,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":e[6]||(e[6]=t=>x.form.user.address=t)},null,512),[[l.Jo,x.form.user.address]])]),(0,a.Lk)("div",Y,[z,(0,a.bo)((0,a.Lk)("textarea",{class:"form-control",id:"note",rows:"3","onUpdate:modelValue":e[7]||(e[7]=t=>x.form.message=t)},null,512),[[l.Jo,x.form.message]])]),(0,a.Lk)("div",Q,[(0,a.Lk)("button",{class:"btn btn-warning",onClick:e[8]||(e[8]=(0,l.D$)(((...t)=>B.addOrder&&B.addOrder(...t)),["prevent"]))},"送出訂單")])])]))]),(0,a.bF)(R,{ref:"delModal",item:x.cart,onDelItem:B.removeCartItem},null,8,["item","onDelItem"])],64)}o(4114);const G={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},P={class:"modal-dialog"},R={class:"modal-content"},Z=(0,a.Lk)("div",{class:"modal-header bg-danger"},[(0,a.Lk)("h5",{class:"modal-title text-light",id:"exampleModalLabel"},"移除商品"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),tt={class:"modal-body"},et={class:"modal-footer"},ot=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function at(t,e,o,l,d,n){return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.Lk)("div",P,[(0,a.Lk)("div",R,[Z,(0,a.Lk)("div",tt,[(0,a.eW)(" 是否確定從購物車移除 "),(0,a.Lk)("strong",null,"「"+(0,s.v_)(o.item.product?.title)+"」",1),(0,a.eW)("，若需購買請重新加入購物車！ ")]),(0,a.Lk)("div",et,[ot,(0,a.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))},"確認刪除")])])])],512)}var st=o(957),lt={props:{item:{}},data(){return{modal:""}},mixins:[st.A]},dt=o(1241);const nt=(0,dt.A)(lt,[["render",at]]);var it=nt,ct=o(4161),rt=o(7649),ut=o(5234),pt={data(){return{cart:{},coupon_code:"",form:{user:{name:"",tel:"",email:"",address:""},message:""}}},components:{CartDelModal:it},computed:{...(0,ut.aH)(rt.A,["carts","total","finalTotal"]),...(0,ut.aH)(ct.A,["isLoading","cartLoadingItem"])},inject:["emitter"],methods:{...(0,ut.i0)(rt.A,["getCart","updateCart"]),openDelModal(t){this.cart={...t};const e=this.$refs.delModal;e.showModal(),console.log("openDelModal",this.cart)},removeCartItem(){const t=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${this.cart.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{const e=this.$refs.delModal;e.hideModal(),this.isLoading=!1,this.$httpMsgState(t,"商品移除"),console.log("removeCartItem",t),this.getCart()}))},removeAll(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$httpMsgState(t,"商品全數移除"),console.log("removeAll",t),this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,this.coupon_code="",this.$httpMsgState(t,"優惠套用"),console.log("addCouponCode",t),t.data.success&&this.getCart()}))},addOrder(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/order",e=this.form;this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t),t.data.success&&this.$router.push(`/shop/checkout/${t.data.orderId}`)}))}},created(){this.getCart()}};const mt=(0,dt.A)(pt,[["render",B]]);var ht=mt}}]);
//# sourceMappingURL=434.32bb3bbd.js.map