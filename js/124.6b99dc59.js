"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[124],{5124:function(t,e,o){o.r(e),o.d(e,{default:function(){return N}});var a=o(6768),s=o(4232),i=o(5130);const r={class:"container"},c={class:"row mt-4"},n={class:"col-md-2"},d={class:"row"},l={class:"col-lg-12 col-md-3 col-6"},u=["onClick"],g={class:"col-md-9 col-11 ms-auto"},p={class:"row"},h=["onClick"],v={class:"card-body"},k={class:"card-title mb-4"},C={class:"card-text float-end"},L={class:"d-flex justify-content-center"},b=["disabled","onClick"],f={key:0,class:"spinner-border spinner-border-sm",role:"status"},m=(0,a.Lk)("span",{class:"visually-hidden"},"Loading...",-1),y=[m],w=(0,a.Lk)("i",{class:"bi bi-cart4"},null,-1);function A(t,e,o,m,A,x){const P=(0,a.g2)("ShopNavbar"),I=(0,a.g2)("LoadingOverlay");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(P),(0,a.bF)(I,{active:t.isLoading},null,8,["active"]),(0,a.Lk)("div",r,[(0,a.Lk)("div",c,[(0,a.Lk)("div",n,[(0,a.Lk)("div",d,[(0,a.Lk)("div",l,[(0,a.Lk)("button",{type:"button",class:(0,s.C4)(["btn btn-outline-warning fw-bold text-center mb-4 w-100",{active:""===A.filterCategory}]),onClick:e[0]||(e[0]=(0,i.D$)((t=>A.filterCategory=""),["prevent"]))},"全部商品 ",2)]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.categories,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"col-lg-12 col-md-3 col-6"},[(0,a.Lk)("button",{type:"button",class:(0,s.C4)(["btn btn-outline-warning fw-bold text-center mb-4 w-100",{active:A.filterCategory===t}]),onClick:(0,i.D$)((e=>A.filterCategory=t),["prevent"])},(0,s.v_)(t),11,u)])))),128))])]),(0,a.Lk)("div",g,[(0,a.Lk)("div",p,[(0,a.Lk)("div",null,(0,s.v_)(x.filterCategories.category),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(x.filterCategories,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,class:"card mx-3 mb-4 shadow rounded p-0",style:{width:"18rem"}},[(0,a.Lk)("a",{href:"",onClick:(0,i.D$)((t=>x.getProduct(e.id)),["prevent"])},[(0,a.Lk)("div",{style:(0,s.Tr)([{height:"200px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${e.imageUrl})`}])},null,4)],8,h),(0,a.Lk)("div",v,[(0,a.Lk)("h6",k,[(0,a.eW)((0,s.v_)(e.title)+" ",1),(0,a.Lk)("span",C,"NT$ "+(0,s.v_)(e.price),1)]),(0,a.Lk)("div",L,[(0,a.Lk)("button",{class:"btn btn-outline-warning w-100",disabled:t.cartLoadingItem===e.id,onClick:o=>t.addCart(e.id)},[t.cartLoadingItem===e.id?((0,a.uX)(),(0,a.CE)("div",f,y)):(0,a.Q3)("",!0),w,(0,a.eW)(" 加入購物車 ")],8,b)])])])))),128))])])])])],64)}o(4114);var x=o(2258),P=o(4373),I=o(5234),$=o(4161),_=o(7649);const E=(0,$.A)(),X=(0,_.A)();var F=(0,I.nY)("productState",{state:()=>({products:[],categories:{},pagination:{}}),getters:{},actions:{getAllProducts(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/products/all";E.isLoading=!0,P.A.get(t).then((t=>{E.isLoading=!1,console.log("getAllProducts",t.data),this.products=t.data.products;const e=this.products.map((t=>t.category)),o=e.filter(((t,o)=>e.indexOf(t)===o));this.categories=o}))},getProducts(t=1){const e=`https://vue3-course-api.hexschool.io/api/ecshop-api/products?page=${t}`;E.isLoading=!0,P.A.get(e).then((t=>{E.isLoading=!1,console.log("getProducts",t.data),this.products=t.data.products,this.pagination=t.data.pagination;const e=this.products.map((t=>t.category)),o=e.filter(((t,o)=>e.indexOf(t)===o));this.categories=o}))},addCart(t){const e="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";E.cartLoadingItem=t;const o={product_id:t,qty:1};P.A.post(e,{data:o}).then((t=>{E.cartLoadingItem="",console.log("addCart",t),t.data.success&&X.getCart()}))}}}),D={data(){return{filterCategory:""}},components:{ShopNavbar:x.A},inject:["emitter"],computed:{...(0,I.aH)(F,["products","categories"]),...(0,I.aH)($.A,["isLoading","cartLoadingItem"]),...(0,I.aH)(_.A,["carts"]),filterCategories(){let t=this.products;return this.filterCategory&&(t=t.filter((t=>t.category.toLowerCase().includes(this.filterCategory.toLowerCase())))),t.sort(((t,e)=>t.price-e.price))}},methods:{...(0,I.i0)(F,["getAllProducts"]),...(0,I.i0)(F,["getProducts"]),...(0,I.i0)(_.A,["getCart"]),getProduct(t){this.$router.push(`/product/${t}`)},...(0,I.i0)(F,["addCart"])},created(){this.getAllProducts(),this.getCart()}},H=o(1241);const K=(0,H.A)(D,[["render",A]]);var N=K}}]);
//# sourceMappingURL=124.6b99dc59.js.map