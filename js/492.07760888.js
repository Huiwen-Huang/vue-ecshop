"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[492],{9415:function(t,e,o){o.r(e),o.d(e,{default:function(){return kt}});var l=o(6768),s=o(4232),a=o(5130),d=o.p+"img/cartEmpty.0dfebce0.jpg";const n={class:"container"},i={key:0,class:"row"},r={class:"col text-center"},c={class:"text-secondary mt-4 fs-5"},u=(0,l.Lk)("img",{src:d,alt:"cartEmpty",style:{width:"500px"}},null,-1),p={key:1,class:"row"},m={class:"col-md-12 mb-4"},h={class:"table align-middle"},k=(0,l.Lk)("thead",null,[(0,l.Lk)("tr",null,[(0,l.Lk)("th",{style:{width:"10%"}}),(0,l.Lk)("th",{class:"ps-5",style:{width:"30%"}},"商品資料"),(0,l.Lk)("th",{style:{width:"15%"}},"單價"),(0,l.Lk)("th",{style:{width:"8%"}},"數量"),(0,l.Lk)("th",{class:"text-end",style:{width:"25%"}},"小計"),(0,l.Lk)("th",{class:"text-end",style:{width:"20%"}})])],-1),L={class:"ps-5"},b={class:"input-group input-group-sm"},v=["disabled","onUpdate:modelValue","onChange"],g={class:"input-group-text"},f={class:"text-end"},y={class:"text-end"},C=["onClick"],x=(0,l.Lk)("i",{class:"bi bi-x"},null,-1),$=[x],w=(0,l.Lk)("td",{colspan:"5",class:"text-end"},"合計",-1),M={class:"text-end"},_={key:0},A=(0,l.Lk)("td",{colspan:"5",class:"text-end"},"套用優惠代碼",-1),I={class:"text-end"},E=(0,l.Lk)("td",{colspan:"5",class:"text-end fw-bold"},"結帳總金額",-1),U={class:"text-end fw-bold"},D={class:"input-group mb-3 input-group-sm"},T={class:"input-group-append"},V={class:"text-end mt-4"},J={class:"col-md-7 mx-auto shadow rounded px-5 mt-4 mb-4"},X=(0,l.Lk)("h2",{class:"mt-5"},"訂購資訊",-1),F=(0,l.Lk)("hr",{class:"mb-4"},null,-1),N={class:"mb-3"},S=(0,l.Lk)("label",{for:"name",class:"form-label"},"訂購人姓名",-1),W={class:"mb-3"},O=(0,l.Lk)("label",{for:"tel",class:"form-label"},"訂購人電話",-1),j={class:"mb-3"},q=(0,l.Lk)("label",{for:"eamil",class:"form-label"},"訂購人信箱",-1),H={class:"mb-3"},K=(0,l.Lk)("label",{for:"address",class:"form-label"},"收件地址",-1),z={class:"mb-3"},Q=(0,l.Lk)("label",{for:"note",class:"form-label"},"訂單備註",-1),B={class:"text-end mt-4 mb-4"};function G(t,e,o,d,x,G){const P=(0,l.g2)("ShopNavbar"),R=(0,l.g2)("LoadingOverlay"),Y=(0,l.g2)("router-link"),Z=(0,l.g2)("CartDelModal");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.bF)(P),(0,l.bF)(R,{active:t.isLoading},null,8,["active"]),(0,l.Lk)("div",n,[0===this.total?((0,l.uX)(),(0,l.CE)("div",i,[(0,l.Lk)("div",r,[(0,l.Lk)("p",c,[(0,l.eW)("購物車尚內無商品， "),(0,l.bF)(Y,{to:"/shop/products",class:"link-secondary"},{default:(0,l.k6)((()=>[(0,l.eW)("點我")])),_:1}),(0,l.eW)(" 繼續選購！")]),u])])):((0,l.uX)(),(0,l.CE)("div",p,[(0,l.Lk)("div",m,[(0,l.Lk)("div",null,[(0,l.Lk)("table",h,[k,(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(t.carts,(e=>((0,l.uX)(),(0,l.CE)("tr",{key:e.product.id},[(0,l.Lk)("td",null,[(0,l.Lk)("div",{style:(0,s.Tr)([{height:"80px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),(0,l.Lk)("td",L,(0,s.v_)(e.product.title),1),(0,l.Lk)("td",null,[(0,l.Lk)("div",null,"NT$ "+(0,s.v_)(e.product.price),1)]),(0,l.Lk)("td",null,[(0,l.Lk)("div",b,[(0,l.bo)((0,l.Lk)("input",{type:"number",class:"form-control",disabled:t.cartLoadingItem===e.id,"onUpdate:modelValue":t=>e.qty=t,min:"1",onChange:o=>t.updateCart(e)},null,40,v),[[a.Jo,e.qty,void 0,{number:!0}]]),(0,l.Lk)("div",g,"/ "+(0,s.v_)(e.product.unit),1)])]),(0,l.Lk)("td",f,[(0,l.Lk)("div",null,"NT$ "+(0,s.v_)(t.$filters.currency(e.total)),1)]),(0,l.Lk)("td",y,[(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:t=>G.openDelModal(e)},$,8,C)])])))),128))]),(0,l.Lk)("tfoot",null,[(0,l.Lk)("tr",null,[w,(0,l.Lk)("td",M,"NT$ "+(0,s.v_)(t.$filters.currency(this.total)),1)]),this.total!==this.finalTotal?((0,l.uX)(),(0,l.CE)("tr",_,[A,(0,l.Lk)("td",I,(0,s.v_)(this.carts[0]?.coupon?.code),1)])):(0,l.Q3)("",!0),(0,l.Lk)("tr",null,[E,(0,l.Lk)("td",U,"NT$ "+(0,s.v_)(t.$filters.currency(this.finalTotal)),1)])])]),(0,l.Lk)("div",D,[(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control me-3",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>x.coupon_code=t)},null,512),[[a.Jo,x.coupon_code]]),(0,l.Lk)("div",T,[(0,l.Lk)("button",{class:"btn btn-outline-warning",type:"button",onClick:e[1]||(e[1]=(...t)=>G.addCouponCode&&G.addCouponCode(...t))}," 套用優惠 ")])]),(0,l.Lk)("div",V,[(0,l.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(...t)=>G.removeAll&&G.removeAll(...t))}," 移除購物車 ")])])]),(0,l.Lk)("form",J,[X,F,(0,l.Lk)("div",N,[S,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[3]||(e[3]=t=>x.form.user.name=t)},null,512),[[a.Jo,x.form.user.name]])]),(0,l.Lk)("div",W,[O,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"tel","onUpdate:modelValue":e[4]||(e[4]=t=>x.form.user.tel=t)},null,512),[[a.Jo,x.form.user.tel]])]),(0,l.Lk)("div",j,[q,(0,l.bo)((0,l.Lk)("input",{type:"email",class:"form-control",id:"eamil","onUpdate:modelValue":e[5]||(e[5]=t=>x.form.user.email=t)},null,512),[[a.Jo,x.form.user.email]])]),(0,l.Lk)("div",H,[K,(0,l.bo)((0,l.Lk)("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":e[6]||(e[6]=t=>x.form.user.address=t)},null,512),[[a.Jo,x.form.user.address]])]),(0,l.Lk)("div",z,[Q,(0,l.bo)((0,l.Lk)("textarea",{class:"form-control",id:"note",rows:"3","onUpdate:modelValue":e[7]||(e[7]=t=>x.form.message=t)},null,512),[[a.Jo,x.form.message]])]),(0,l.Lk)("div",B,[(0,l.Lk)("button",{class:"btn btn-warning",onClick:e[8]||(e[8]=(0,a.D$)(((...t)=>G.addOrder&&G.addOrder(...t)),["prevent"]))},"送出訂單")])])]))]),(0,l.bF)(Z,{ref:"delModal",item:x.cart,onDelItem:G.removeCartItem},null,8,["item","onDelItem"])],64)}o(4114);var P=o(7961);const R={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},Y={class:"modal-dialog"},Z={class:"modal-content"},tt=(0,l.Lk)("div",{class:"modal-header bg-danger"},[(0,l.Lk)("h5",{class:"modal-title text-light",id:"exampleModalLabel"},"移除商品"),(0,l.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),et={class:"modal-body"},ot={class:"modal-footer"},lt=(0,l.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function st(t,e,o,a,d,n){return(0,l.uX)(),(0,l.CE)("div",R,[(0,l.Lk)("div",Y,[(0,l.Lk)("div",Z,[tt,(0,l.Lk)("div",et,[(0,l.eW)(" 是否確定從購物車移除 "),(0,l.Lk)("strong",null,"「"+(0,s.v_)(o.item.product?.title)+"」",1),(0,l.eW)("，若需購買請重新加入購物車！ ")]),(0,l.Lk)("div",ot,[lt,(0,l.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))},"確認刪除")])])])],512)}var at=o(957),dt={props:{item:{}},data(){return{modal:""}},mixins:[at.A]},nt=o(1241);const it=(0,nt.A)(dt,[["render",st]]);var rt=it,ct=o(4161),ut=o(7649),pt=o(5234),mt={data(){return{cart:{},coupon_code:"",form:{user:{name:"",tel:"",email:"",address:""},message:""}}},components:{CartDelModal:rt,ShopNavbar:P.A},computed:{...(0,pt.aH)(ut.A,["carts","total","finalTotal"]),...(0,pt.aH)(ct.A,["isLoading","cartLoadingItem"])},inject:["emitter"],methods:{...(0,pt.i0)(ut.A,["getCart","updateCart"]),openDelModal(t){this.cart={...t};const e=this.$refs.delModal;e.showModal(),console.log("openDelModal",this.cart)},removeCartItem(){const t=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${this.cart.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{const e=this.$refs.delModal;e.hideModal(),this.isLoading=!1,this.$httpMsgState(t,"商品移除"),console.log("removeCartItem",t),this.getCart()}))},removeAll(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$httpMsgState(t,"商品全數移除"),console.log("removeAll",t),this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,this.coupon_code="",this.$httpMsgState(t,"優惠套用"),console.log("addCouponCode",t),t.data.success&&this.getCart()}))},addOrder(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/order",e=this.form;this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t),t.data.success&&this.$router.push(`/shop/checkout/${t.data.orderId}`)}))}},created(){this.getCart()}};const ht=(0,nt.A)(mt,[["render",G]]);var kt=ht}}]);
//# sourceMappingURL=492.07760888.js.map