"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[693],{4324:function(e,t,o){o.d(t,{A:function(){return L}});var a=o(6768),s=o(4232),n=o(5130);const l={class:"d-flex justify-content-center"},i={"aria-label":"Page navigation example"},p={class:"pagination"},d=(0,a.Lk)("span",{"aria-hidden":"true"},"«",-1),c=[d],u=["onClick"],r=(0,a.Lk)("span",{"aria-hidden":"true"},"»",-1),h=[r];function m(e,t,o,d,r,m){return(0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("nav",i,[(0,a.Lk)("ul",p,[(0,a.Lk)("li",{class:(0,s.C4)(["page-item text-warning",{disabled:!1===o.pages.has_pre}])},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,n.D$)((e=>m.updatePage(o.pages.current_page-1)),["prevent"]))},c)],2),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.pages.total_pages,(e=>((0,a.uX)(),(0,a.CE)("li",{class:(0,s.C4)(["page-item",{active:e===o.pages.current_page}]),key:e},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,n.D$)((t=>m.updatePage(e)),["prevent"])},(0,s.v_)(e),9,u)],2)))),128)),(0,a.Lk)("li",{class:(0,s.C4)(["page-item",{disabled:!1===o.pages.has_next}])},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,n.D$)((e=>m.updatePage(o.pages.current_page+1)),["prevent"]))},h)],2)])])])}var k={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)}}},b=o(1241);const g=(0,b.A)(k,[["render",m]]);var L=g},5693:function(e,t,o){o.r(t),o.d(t,{default:function(){return Q}});var a=o(6768),s=o(4232);const n={class:"container"},l={class:"text-end mt-4"},i={class:"table mt-4"},p=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"ps-4",style:{width:"300px"}},"優惠名稱"),(0,a.Lk)("th",{class:"text-center",width:"120"},"優惠代碼"),(0,a.Lk)("th",{class:"text-center",width:"120"},"折扣 %"),(0,a.Lk)("th",{class:"text-center",width:"120"},"到期日"),(0,a.Lk)("th",{class:"text-center",width:"120"},"是否上架"),(0,a.Lk)("th",{class:"text-center",width:"120"},"編輯")])],-1),d={class:"ps-4"},c={class:"text-center"},u={class:"text-center"},r={class:"text-center"},h={class:"text-center"},m={key:0,class:"text-success"},k={key:1,class:"text-muted"},b={class:"text-center"},g={class:"btn-group"},L=["onClick"],C=["disabled","onClick"];function v(e,t,o,v,f,_){const x=(0,a.g2)("LoadingOverlay"),y=(0,a.g2)("CouponModal"),w=(0,a.g2)("PaginationCard");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(x,{active:f.isLoading},null,8,["active"]),(0,a.Lk)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("button",{class:"btn btn-success",type:"button",onClick:t[0]||(t[0]=e=>_.openModal(!0))}," 新增優惠卷 ")]),(0,a.Lk)("table",i,[p,(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(f.coupons,(t=>((0,a.uX)(),(0,a.CE)("tr",{key:t.id},[(0,a.Lk)("td",d,(0,s.v_)(t.title),1),(0,a.Lk)("td",c,(0,s.v_)(t.code),1),(0,a.Lk)("td",u,(0,s.v_)(t.percent)+" %",1),(0,a.Lk)("td",r,(0,s.v_)(e.$filters.date(t.due_date)),1),(0,a.Lk)("td",h,[t.is_enabled?((0,a.uX)(),(0,a.CE)("span",m,"上架")):((0,a.uX)(),(0,a.CE)("span",k,"未上架"))]),(0,a.Lk)("td",b,[(0,a.Lk)("div",g,[(0,a.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:e=>_.openModal(!1,t)},"編輯",8,L),(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm",disabled:this.status.loadingItem===t.id,onClick:e=>_.delCoupon(t.id)},"刪除",8,C)])])])))),128))])])]),(0,a.bF)(y,{ref:"couponModal",coupon:f.tempCoupon,onUpdateCoupon:_.updateCoupon},null,8,["coupon","onUpdateCoupon"]),(0,a.bF)(w,{pages:f.pagination,onEmitPages:_.getCoupons},null,8,["pages","onEmitPages"])],64)}var f=o(5130);const _={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},x={class:"modal-dialog",role:"document"},y={class:"modal-content"},w=(0,a.Lk)("div",{class:"modal-header"},[(0,a.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"優惠券"),(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),M={class:"modal-body"},$={class:"mb-3"},E=(0,a.Lk)("label",{for:"title"},"優惠名稱",-1),P={class:"mb-3"},X=(0,a.Lk)("label",{for:"coupon_code"},"優惠代碼",-1),I={class:"mb-3"},U=(0,a.Lk)("label",{for:"price"},"折扣 %",-1),A={class:"mb-3"},D=(0,a.Lk)("label",{for:"due_date"},"活動到期日",-1),F={class:"mb-3"},V={class:"form-check"},J=(0,a.Lk)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),N={class:"modal-footer"},K=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function S(e,t,o,s,n,l){return(0,a.uX)(),(0,a.CE)("div",_,[(0,a.Lk)("div",x,[(0,a.Lk)("div",y,[w,(0,a.Lk)("div",M,[(0,a.Lk)("div",$,[E,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>n.tempCoupon.title=e),placeholder:"請輸入優惠名稱"},null,512),[[f.Jo,n.tempCoupon.title]])]),(0,a.Lk)("div",P,[X,(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>n.tempCoupon.code=e),placeholder:"請輸入優惠代碼"},null,512),[[f.Jo,n.tempCoupon.code]])]),(0,a.Lk)("div",I,[U,(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[2]||(t[2]=e=>n.tempCoupon.percent=e),placeholder:"請輸入折扣%"},null,512),[[f.Jo,n.tempCoupon.percent,void 0,{number:!0}]])]),(0,a.Lk)("div",A,[D,(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[3]||(t[3]=e=>n.due_date=e)},null,512),[[f.Jo,n.due_date]])]),(0,a.Lk)("div",F,[(0,a.Lk)("div",V,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>n.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[f.lH,n.tempCoupon.is_enabled]]),J])])]),(0,a.Lk)("div",N,[K,(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",n.tempCoupon))},"保存 ")])])])],512)}var j=o(957),O={name:"couponModal",props:{coupon:{}},data(){return{tempCoupon:{},due_date:""}},emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[j.A]},T=o(1241);const H=(0,T.A)(O,[["render",S]]);var q=H,z=o(4324),B={data(){return{coupons:[],tempCoupon:{},isLoading:!1,isNew:!1,status:{loadingItem:""},pagination:{}}},components:{CouponModal:q,PaginationCard:z.A},inject:["emitter"],methods:{getCoupons(e=1){const t=`https://vue3-course-api.hexschool.io/api/ecshop-api/admin/coupons/?page=${e}`;this.isLoading=!0,this.$http.get(t).then((e=>{this.isLoading=!1,console.log(e.data),this.coupons=e.data.coupons,this.pagination=e.data.pagination}))},openModal(e,t){this.tempCoupon=e?{due_date:(new Date).getTime()/1e3}:{...t},this.isNew=e;const o=this.$refs.couponModal;o.showModal()},updateCoupon(e){this.tempCoupon=e;const t=this.$refs.couponModal;let o="https://vue3-course-api.hexschool.io/api/ecshop-api/admin/coupon",a="post";this.isNew||(o=`https://vue3-course-api.hexschool.io/api/ecshop-api/admin/coupon/${e.id}`,a="put"),this.$http[a](o,{data:this.tempCoupon}).then((e=>{console.log(e),t.hideModal(),this.getCoupons(),this.$httpMsgState(e,"更新")}))},delCoupon(e){const t=`https://vue3-course-api.hexschool.io/api/ecshop-api/admin/coupon/${e}`;this.status.loadingItem=e,this.$http.delete(t).then((e=>{this.status.loadingItem="",this.getCoupons(),console.log(e)}))}},created(){this.getCoupons()}};const G=(0,T.A)(B,[["render",v]]);var Q=G}}]);
//# sourceMappingURL=693.e4b88c22.js.map