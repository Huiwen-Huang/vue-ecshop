"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[499],{848:function(t,e,o){o.r(e),o.d(e,{default:function(){return ut}});var s=o(6768),a=o(4232),l=o(5130),d=o.p+"img/cartEmpty.0dfebce0.jpg";const i={class:"container"},n={key:0,class:"row"},r={class:"col text-center"},c={class:"text-secondary mt-4 fs-5"},u=(0,s.Lk)("img",{src:d,alt:"cartEmpty",style:{width:"500px"}},null,-1),p={key:1,class:"row"},h={class:"col-md-12 mb-4"},m={class:"table align-middle"},k=(0,s.Lk)("thead",null,[(0,s.Lk)("tr",null,[(0,s.Lk)("th",{style:{width:"10%"}}),(0,s.Lk)("th",{class:"ps-5",style:{width:"30%"}},"商品資料"),(0,s.Lk)("th",{style:{width:"15%"}},"單價"),(0,s.Lk)("th",{style:{width:"8%"}},"數量"),(0,s.Lk)("th",{class:"text-end",style:{width:"25%"}},"小計"),(0,s.Lk)("th",{class:"text-end",style:{width:"20%"}})])],-1),L={class:"ps-5"},b={class:"input-group input-group-sm"},g=["disabled","onUpdate:modelValue","onChange"],v={class:"input-group-text"},f={class:"text-end"},y={class:"text-end"},C=["onClick"],x=(0,s.Lk)("i",{class:"bi bi-x"},null,-1),$=[x],_=(0,s.Lk)("td",{colspan:"5",class:"text-end"},"合計",-1),w={class:"text-end"},M={key:0},I=(0,s.Lk)("td",{colspan:"5",class:"text-end"},"套用優惠代碼",-1),E={class:"text-end"},T=(0,s.Lk)("td",{colspan:"5",class:"text-end fw-bold"},"結帳總金額",-1),U={class:"text-end fw-bold"},D={class:"input-group mb-3 input-group-sm"},V={class:"input-group-append"},A={class:"text-end mt-4"},J={class:"col-md-7 mx-auto shadow rounded px-5 mt-4 mb-4"},X=(0,s.Lk)("h2",{class:"mt-5"},"訂購資訊",-1),F=(0,s.Lk)("hr",{class:"mb-4"},null,-1),W={class:"mb-3"},q=(0,s.Lk)("label",{for:"name",class:"form-label"},"訂購人姓名",-1),N={class:"mb-3"},O=(0,s.Lk)("label",{for:"tel",class:"form-label"},"訂購人電話",-1),S={class:"mb-3"},j=(0,s.Lk)("label",{for:"eamil",class:"form-label"},"訂購人信箱",-1),K={class:"mb-3"},z=(0,s.Lk)("label",{for:"address",class:"form-label"},"收件地址",-1),Q={class:"mb-3"},B=(0,s.Lk)("label",{for:"note",class:"form-label"},"訂單備註",-1),G={class:"text-end mt-4 mb-4"};function H(t,e,o,d,x,H){const P=(0,s.g2)("LoadingOverlay"),R=(0,s.g2)("router-link"),Y=(0,s.g2)("CartDelModal");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(P,{active:x.isLoading},null,8,["active"]),(0,s.Lk)("div",i,[0===this.total?((0,s.uX)(),(0,s.CE)("div",n,[(0,s.Lk)("div",r,[(0,s.Lk)("p",c,[(0,s.eW)("購物車尚內無商品， "),(0,s.bF)(R,{to:"/shop/products",class:"link-secondary"},{default:(0,s.k6)((()=>[(0,s.eW)("點我")])),_:1}),(0,s.eW)(" 繼續選購！")]),u])])):((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",h,[(0,s.Lk)("div",null,[(0,s.Lk)("table",m,[k,(0,s.Lk)("tbody",null,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(x.carts,(e=>((0,s.uX)(),(0,s.CE)("tr",{key:e.product.id},[(0,s.Lk)("td",null,[(0,s.Lk)("div",{style:(0,a.Tr)([{height:"80px","background-size":"cover","background-position":"top"},{backgroundImage:`url(${e.product.imageUrl})`}])},null,4)]),(0,s.Lk)("td",L,(0,a.v_)(e.product.title),1),(0,s.Lk)("td",null,[(0,s.Lk)("div",null,"NT$ "+(0,a.v_)(e.product.price),1)]),(0,s.Lk)("td",null,[(0,s.Lk)("div",b,[(0,s.bo)((0,s.Lk)("input",{type:"number",class:"form-control",disabled:x.status.loadingItem===e.id,"onUpdate:modelValue":t=>e.qty=t,min:"1",onChange:t=>H.updateCart(e)},null,40,g),[[l.Jo,e.qty,void 0,{number:!0}]]),(0,s.Lk)("div",v,"/ "+(0,a.v_)(e.product.unit),1)])]),(0,s.Lk)("td",f,[(0,s.Lk)("div",null,"NT$ "+(0,a.v_)(t.$filters.currency(e.total)),1)]),(0,s.Lk)("td",y,[(0,s.Lk)("button",{type:"button",class:"btn btn-outline-secondary btn-sm",onClick:t=>H.openDelModal(e)},$,8,C)])])))),128))]),(0,s.Lk)("tfoot",null,[(0,s.Lk)("tr",null,[_,(0,s.Lk)("td",w,"NT$ "+(0,a.v_)(t.$filters.currency(this.total)),1)]),this.total!==this.finalTotal?((0,s.uX)(),(0,s.CE)("tr",M,[I,(0,s.Lk)("td",E,(0,a.v_)(this.carts[0]?.coupon?.code),1)])):(0,s.Q3)("",!0),(0,s.Lk)("tr",null,[T,(0,s.Lk)("td",U,"NT$ "+(0,a.v_)(t.$filters.currency(this.finalTotal)),1)])])]),(0,s.Lk)("div",D,[(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control me-3",placeholder:"請輸入優惠碼","onUpdate:modelValue":e[0]||(e[0]=t=>x.coupon_code=t)},null,512),[[l.Jo,x.coupon_code]]),(0,s.Lk)("div",V,[(0,s.Lk)("button",{class:"btn btn-outline-warning",type:"button",onClick:e[1]||(e[1]=(...t)=>H.addCouponCode&&H.addCouponCode(...t))}," 套用優惠 ")])]),(0,s.Lk)("div",A,[(0,s.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[2]||(e[2]=(...t)=>H.removeAll&&H.removeAll(...t))}," 移除購物車 ")])])]),(0,s.Lk)("form",J,[X,F,(0,s.Lk)("div",W,[q,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[3]||(e[3]=t=>x.form.user.name=t)},null,512),[[l.Jo,x.form.user.name]])]),(0,s.Lk)("div",N,[O,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"tel","onUpdate:modelValue":e[4]||(e[4]=t=>x.form.user.tel=t)},null,512),[[l.Jo,x.form.user.tel]])]),(0,s.Lk)("div",S,[j,(0,s.bo)((0,s.Lk)("input",{type:"email",class:"form-control",id:"eamil","onUpdate:modelValue":e[5]||(e[5]=t=>x.form.user.email=t)},null,512),[[l.Jo,x.form.user.email]])]),(0,s.Lk)("div",K,[z,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",id:"address","onUpdate:modelValue":e[6]||(e[6]=t=>x.form.user.address=t)},null,512),[[l.Jo,x.form.user.address]])]),(0,s.Lk)("div",Q,[B,(0,s.bo)((0,s.Lk)("textarea",{class:"form-control",id:"note",rows:"3","onUpdate:modelValue":e[7]||(e[7]=t=>x.form.message=t)},null,512),[[l.Jo,x.form.message]])]),(0,s.Lk)("div",G,[(0,s.Lk)("button",{class:"btn btn-warning",onClick:e[8]||(e[8]=(0,l.D$)(((...t)=>H.addOrder&&H.addOrder(...t)),["prevent"]))},"送出訂單")])])]))]),(0,s.bF)(Y,{ref:"delModal",item:x.cart,onDelItem:H.removeCartItem},null,8,["item","onDelItem"])],64)}o(4114);const P={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},R={class:"modal-dialog"},Y={class:"modal-content"},Z=(0,s.Lk)("div",{class:"modal-header bg-danger"},[(0,s.Lk)("h5",{class:"modal-title text-light",id:"exampleModalLabel"},"移除商品"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),tt={class:"modal-body"},et={class:"modal-footer"},ot=(0,s.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消",-1);function st(t,e,o,l,d,i){return(0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",R,[(0,s.Lk)("div",Y,[Z,(0,s.Lk)("div",tt,[(0,s.eW)(" 是否確定從購物車移除 "),(0,s.Lk)("strong",null,"「"+(0,a.v_)(o.item.product?.title)+"」",1),(0,s.eW)("，若需購買請重新加入購物車！ ")]),(0,s.Lk)("div",et,[ot,(0,s.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e[0]||(e[0]=e=>t.$emit("del-item"))},"確認刪除")])])])],512)}var at=o(957),lt={props:{item:{}},data(){return{modal:""}},mixins:[at.A]},dt=o(1241);const it=(0,dt.A)(lt,[["render",st]]);var nt=it,rt={data(){return{carts:[],cart:{},total:"",finalTotal:"",isLoading:!1,status:{loadingItem:""},coupon_code:"",form:{user:{name:"",tel:"",email:"",address:""},message:""}}},components:{CartDelModal:nt},inject:["emitter"],methods:{getCart(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{this.isLoading=!1,console.log("getCart",t),t.data.success&&(this.carts=t.data.data.carts,this.total=t.data.data.total,this.finalTotal=t.data.data.final_total)}))},openDelModal(t){this.cart={...t};const e=this.$refs.delModal;e.showModal(),console.log("openDelModal",this.cart)},removeCartItem(){const t=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${this.cart.id}`;this.isLoading=!0,this.$http.delete(t).then((t=>{const e=this.$refs.delModal;e.hideModal(),this.isLoading=!1,this.$httpMsgState(t,"商品移除"),console.log("removeCartItem",t),this.getCart()}))},removeAll(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/carts";this.isLoading=!0,this.$http.delete(t).then((t=>{this.isLoading=!1,this.$httpMsgState(t,"商品全數移除"),console.log("removeAll",t),this.getCart()}))},updateCart(t){const e=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${t.id}`,o={product_id:t.product_id,qty:t.qty};this.isLoading=!0,this.status.loadingItem=t.id,this.$http.put(e,{data:o}).then((t=>{console.log("updateCart",t),this.isLoading=!1,this.status.loadingItem="",this.getCart()}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,this.coupon_code="",this.$httpMsgState(t,"優惠套用"),console.log("addCouponCode",t),t.data.success&&this.getCart()}))},addOrder(){const t="https://vue3-course-api.hexschool.io/api/ecshop-api/order",e=this.form;this.isLoading=!0,this.$http.post(t,{data:e}).then((t=>{this.isLoading=!1,console.log(t),t.data.success&&this.$router.push(`/shop/checkout/${t.data.orderId}`)}))}},created(){this.getCart()}};const ct=(0,dt.A)(rt,[["render",H]]);var ut=ct}}]);
//# sourceMappingURL=499.ee6b749c.js.map