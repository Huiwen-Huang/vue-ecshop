"use strict";(self["webpackChunkvue_ecshop"]=self["webpackChunkvue_ecshop"]||[]).push([[844],{7649:function(e,a,s){var t=s(4373),l=s(5234),o=s(4161);const i=(0,o.A)();a.A=(0,l.nY)("cartState",{state:()=>({carts:[],total:"",finalTotal:""}),actions:{getCart(){const e="https://vue3-course-api.hexschool.io/api/ecshop-api/cart";i.isLoading=!0,t.A.get(e).then((e=>{i.isLoading=!1,console.log("getCart",e),e.data.success&&(this.carts=e.data.data.carts,this.total=e.data.data.total,this.finalTotal=e.data.data.final_total)}))},updateCart(e){const a=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${e.id}`,s={product_id:e.product_id,qty:e.qty};i.isLoading=!0,i.cartLoadingItem=e.id,t.A.put(a,{data:s}).then((e=>{console.log("updateCart",e),i.isLoading=!1,i.cartLoadingItem="",this.getCart()}))},delProduct(e){const a=`https://vue3-course-api.hexschool.io/api/ecshop-api/cart/${e.id}`;this.isLoading=!0,t.A.delete(a).then((e=>{this.isLoading=!1,console.log("removeCartItem",e),this.getCart()}))}}})},4161:function(e,a,s){var t=s(5234);a.A=(0,t.nY)("statusState",{state:()=>({isLoading:!1,cartLoadingItem:""})})},5844:function(e,a,s){s.r(a),s.d(a,{default:function(){return oe}});var t=s(6768),l=s(4232),o=s(5130);const i=(0,t.Lk)("div",{class:"loadingio-spinner-ellipsis-nq4q5u6dq7r"},[(0,t.Lk)("div",{class:"ldio-x2uulkbinbj"},[(0,t.Lk)("div"),(0,t.Lk)("div"),(0,t.Lk)("div"),(0,t.Lk)("div"),(0,t.Lk)("div")])],-1),r={class:"container"},d={class:"row mb-4"},n={class:"col-md-8 col-10 mx-auto"},c={class:"position-relative m-4"},b=(0,t.Lk)("div",{class:"progress",style:{height:"2px"}},[(0,t.Lk)("div",{class:"progress-bar",role:"progressbar",style:{width:"100%","--bs-progress-bar-bg":"#D6EADF"},"aria-valuenow":"0","aria-valuemin":"0","aria-valuemax":"100"})],-1),u=(0,t.Lk)("button",{type:"button",class:"position-absolute top-0 start-0 translate-middle btn btn-sm rounded-pill",style:{width:"2rem",height:"2rem","--bs-btn-bg":"#D6EADF","--bs-btn-color":"#fff","--bs-btn-hover-color":"#fff","--bs-btn-hover-bg":"#A7C4B5","--bs-btn-active-color":"#fff","--bs-btn-active-bg":"#A7C4B5"}},"1",-1),m=(0,t.Lk)("button",{type:"button",class:"position-absolute top-0 start-50 translate-middle btn btn-sm rounded-pill",style:{width:"2rem",height:"2rem","--bs-btn-bg":"#A7C4B5","--bs-btn-color":"#fff","--bs-btn-hover-color":"#fff","--bs-btn-hover-bg":"#A7C4B5","--bs-btn-active-color":"#fff","--bs-btn-active-bg":"#A7C4B5"}},"2",-1),p=(0,t.Lk)("button",{type:"button",class:"position-absolute top-0 start-100 translate-middle btn btn-sm rounded-pill",style:{width:"2rem",height:"2rem","--bs-btn-bg":"#D6EADF","--bs-btn-color":"#fff","--bs-btn-hover-color":"#fff","--bs-btn-hover-bg":"#A7C4B5","--bs-btn-active-color":"#fff","--bs-btn-active-bg":"#A7C4B5"}},"3",-1),f=(0,t.Fv)('<div class="row"><div class="col-md-8 col-10 mx-auto"><div class="position-relative m-2"><div class="position-absolute top-0 start-0 translate-middle d-inline mt-2 ms-4">購物車</div><div class="position-absolute top-0 start-50 translate-middle d-inline mt-2 ms-2">填寫資料</div><div class="position-absolute top-0 start-100 translate-middle d-inline mt-2" style="width:4rem;">訂單確認</div></div></div></div>',1),v={class:"col-md-7"},h=(0,t.Lk)("h6",{class:"bg-light p-3"},"訂購人資訊",-1),k={class:"border rounded mb-4 p-3"},L={class:"mb-3"},g=(0,t.Lk)("label",{for:"name",class:"form-label"},"訂購人姓名",-1),C={class:"mb-3"},y=(0,t.Lk)("label",{for:"tel",class:"form-label"},"訂購人電話",-1),F={class:"mb-3"},w=(0,t.Lk)("label",{for:"email",class:"form-label"},"訂購人信箱",-1),A={class:"mb-3"},V=(0,t.Lk)("label",{for:"address",class:"form-label"},"取貨地址",-1),x={class:"mb-4"},_=(0,t.Lk)("label",{for:"note",class:"form-label"},"訂單備註",-1),$={class:"col-md-5"},q=(0,t.Lk)("h6",{class:"bg-light p-3"},"取貨及付款資訊",-1),T={class:"border rounded mb-3 p-3"},D={class:"mb-4"},B=(0,t.Lk)("label",{for:"shipping",class:"mb-2"},"取貨方式",-1),U=(0,t.Lk)("option",{value:""},"請選擇取貨方式",-1),E=(0,t.Lk)("option",{value:"自取"},"自取",-1),I=(0,t.Lk)("option",{value:"外送"},"外送",-1),O={class:"mb-4"},S=(0,t.Lk)("label",{for:"pay",class:"mb-2"},"付款方式",-1),j=(0,t.Lk)("option",{value:""},"請選擇付款方式",-1),P=(0,t.Lk)("option",{value:"現金"},"現金",-1),W=(0,t.Lk)("option",{value:"信用卡"},"信用卡",-1),N=(0,t.Lk)("h6",{class:"bg-light p-3"},"訂單資訊",-1),X={class:"p-3 border rounded mb-3"},Y={class:"w-100"},H={class:"mb-3"},J={class:"float-end"},K={key:0,class:"mb-4"},Q={class:"text-warning fw-bold"},z={class:"float-end"},G={class:"fw-bold border-top pt-2"},M={class:"float-end fw-bold"},R={class:"mb-4 d-flex align-items-center justify-content-between"};function Z(e,a,s,Z,ee,ae){const se=(0,t.g2)("LoadingOverlay"),te=(0,t.g2)("router-link"),le=(0,t.g2)("v-field"),oe=(0,t.g2)("error-message"),ie=(0,t.g2)("v-form");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(se,{active:ee.isLoading},{default:(0,t.k6)((()=>[i])),_:1},8,["active"]),(0,t.Lk)("div",r,[(0,t.Lk)("div",d,[(0,t.Lk)("div",n,[(0,t.Lk)("div",c,[b,(0,t.bF)(te,{to:"/cart"},{default:(0,t.k6)((()=>[u])),_:1}),(0,t.bF)(te,{to:"/checkout"},{default:(0,t.k6)((()=>[m])),_:1}),p])]),f]),(0,t.bF)(ie,{class:"row justify-content-around pt-4",onSubmit:ae.addOrder},{default:(0,t.k6)((({errors:s})=>[(0,t.Lk)("div",v,[h,(0,t.Lk)("div",k,[(0,t.Lk)("div",L,[g,(0,t.bF)(le,{type:"text",class:(0,l.C4)(["form-control",{"is-invalid":s["訂購人姓名"]}]),id:"name",name:"訂購人姓名",rules:"required",modelValue:ee.form.user.name,"onUpdate:modelValue":a[0]||(a[0]=e=>ee.form.user.name=e)},null,8,["modelValue","class"]),(0,t.bF)(oe,{name:"訂購人姓名",class:"invalid-feedback"})]),(0,t.Lk)("div",C,[y,(0,t.bF)(le,{type:"text",class:(0,l.C4)(["form-control",{"is-invalid":s["tel"]}]),id:"tel",name:"tel",modelValue:ee.form.user.tel,"onUpdate:modelValue":a[1]||(a[1]=e=>ee.form.user.tel=e),rules:ae.isPhone},null,8,["modelValue","rules","class"]),(0,t.bF)(oe,{name:"tel",class:"invalid-feedback"})]),(0,t.Lk)("div",F,[w,(0,t.bF)(le,{type:"email",class:(0,l.C4)(["form-control",{"is-invalid":s["訂購人信箱"]}]),id:"email",name:"訂購人信箱",rules:"email|required",modelValue:ee.form.user.email,"onUpdate:modelValue":a[2]||(a[2]=e=>ee.form.user.email=e)},null,8,["modelValue","class"]),(0,t.bF)(oe,{name:"訂購人信箱",class:"invalid-feedback"})]),(0,t.Lk)("div",A,[V,(0,t.bF)(le,{type:"text",class:(0,l.C4)(["form-control",{"is-invalid":s["取貨地址"]}]),id:"address",name:"取貨地址",modelValue:ee.form.user.address,"onUpdate:modelValue":a[3]||(a[3]=e=>ee.form.user.address=e),rules:"required"},null,8,["modelValue","class"]),(0,t.bF)(oe,{name:"取貨地址",class:"invalid-feedback"})]),(0,t.Lk)("div",x,[_,(0,t.bo)((0,t.Lk)("textarea",{class:"form-control",id:"note",rows:"3","onUpdate:modelValue":a[4]||(a[4]=e=>ee.form.message=e)},null,512),[[o.Jo,ee.form.message]])])])]),(0,t.Lk)("div",$,[q,(0,t.Lk)("div",T,[(0,t.Lk)("div",D,[B,(0,t.bF)(le,{class:(0,l.C4)(["form-select",{"is-invalid":s["取貨方式"]}]),id:"shipping",name:"取貨方式",modelValue:ee.form.shipping,"onUpdate:modelValue":a[5]||(a[5]=e=>ee.form.shipping=e),as:"select",rules:"required"},{default:(0,t.k6)((()=>[U,E,I])),_:2},1032,["modelValue","class"]),(0,t.bF)(oe,{name:"取貨方式",class:"invalid-feedback"})]),(0,t.Lk)("div",O,[S,(0,t.bF)(le,{class:(0,l.C4)(["form-select",{"is-invalid":s["付款方式"]}]),"aria-label":"Default select example",id:"pay",name:"付款方式",modelValue:ee.form.pay,"onUpdate:modelValue":a[6]||(a[6]=e=>ee.form.pay=e),as:"select",rules:"required"},{default:(0,t.k6)((()=>[j,P,W])),_:2},1032,["modelValue","class"]),(0,t.bF)(oe,{name:"付款方式",class:"invalid-feedback"})])]),N,(0,t.Lk)("div",X,[(0,t.Lk)("div",Y,[(0,t.Lk)("p",H,[(0,t.eW)("合計 "),(0,t.Lk)("span",J,"NT$ "+(0,l.v_)(e.$filters.currency(this.total)),1)]),this.total!==this.finalTotal?((0,t.uX)(),(0,t.CE)("div",K,[(0,t.Lk)("p",Q,[(0,t.eW)("套用優惠代碼 "),(0,t.Lk)("span",z,"- "+(0,l.v_)(this.carts[0]?.coupon?.percent)+"%",1)])])):(0,t.Q3)("",!0),(0,t.Lk)("p",G,[(0,t.eW)("結帳總金額 "),(0,t.Lk)("span",M,"NT$ "+(0,l.v_)(e.$filters.currency(this.finalTotal)),1)])])]),(0,t.Lk)("div",R,[(0,t.Lk)("a",{href:"",class:"link text-secondary",onClick:a[7]||(a[7]=(0,o.D$)(((...e)=>ae.backToCart&&ae.backToCart(...e)),["prevent"]))},"← 返回購物車"),(0,t.Lk)("button",{class:"btn btn-warning",type:"submit",onClick:a[8]||(a[8]=(...e)=>ae.addOrder&&ae.addOrder(...e))},"送出訂單")])])])),_:1},8,["onSubmit"])])],64)}s(4114);var ee=s(7649),ae=s(5234),se={data(){return{isLoading:!1,form:{user:{name:"",tel:"",email:"",address:""},message:"",shipping:"",pay:""}}},computed:{...(0,ae.aH)(ee.A,["total","finalTotal","carts"])},methods:{...(0,ae.i0)(ee.A,["getCart"]),addOrder(){const e="https://vue3-course-api.hexschool.io/api/ecshop-api/order",a=this.form;this.isLoading=!0,this.$http.post(e,{data:a}).then((e=>{this.isLoading=!1,console.log(e),e.data.success&&this.$router.push(`/shop/checkout/${e.data.orderId}`)}))},backToCart(){this.$router.push("/shop/cart")},isPhone(e){const a=/^(09)[0-9]{8}$/;return!!a.test(e)||"須為正確的電話號碼"}},created(){this.getCart()}},te=s(1241);const le=(0,te.A)(se,[["render",Z]]);var oe=le}}]);
//# sourceMappingURL=844.dba20e10.js.map